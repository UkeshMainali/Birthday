<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>üéÇ Happy Birthday! üéÇ</title>
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Nunito:wght@700;900&display=swap"
    rel="stylesheet">
  <style>
    :root {
      --blue: #0088cc;
      --lblue: #00bbff;
      --red: #ff3333;
      --gold: #FFD700;
      --diamond: #00e5ff;
      --grass: #5a8a3c;
      --dirt: #8B6914;
      --pink: #ff69b4;
      --purple: #cc44ff;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html {
      scroll-behavior: smooth;
    }

    body {
      font-family: 'Press Start 2P', monospace;
      background: #87CEEB;
      overflow-x: hidden;
      padding-bottom: 80px;
    }

    @media(hover:hover) {
      body {
        cursor: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='20' height='20'%3E%3Crect x='0' y='0' width='10' height='10' fill='%23FFD700'/%3E%3Crect x='10' y='10' width='10' height='10' fill='%23FFD700'/%3E%3C/svg%3E"), auto;
      }
    }

    .sky {
      position: fixed;
      inset: 0;
      background: linear-gradient(180deg, #87CEEB 0%, #b0e0ff 55%, var(--grass) 55%, #3d5c28 100%);
      z-index: -2;
    }

    .cloud {
      position: fixed;
      background: #fff;
      border-radius: 50px;
      animation: cloudDrift linear infinite;
      z-index: -1;
    }

    @keyframes cloudDrift {
      from {
        transform: translateX(-250px)
      }

      to {
        transform: translateX(110vw)
      }
    }

    .ground {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      height: 50px;
      background: repeating-linear-gradient(90deg, var(--grass) 0 50px, #4a7a2c 50px 100px);
      z-index: 0;
    }

    .ground::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 30px;
      background: repeating-linear-gradient(90deg, var(--dirt) 0 50px, #7a5a10 50px 100px);
    }

    .wrap {
      max-width: 520px;
      margin: 0 auto;
      padding: 12px;
      position: relative;
      z-index: 1;
    }

    .pbox {
      border: 3px solid #000;
      box-shadow: 4px 4px 0 #000;
    }

    /* HEADER */
    .header {
      background: var(--blue);
      border: 3px solid #003366;
      box-shadow: 5px 5px 0 #003366, 0 0 0 6px var(--lblue), 5px 5px 0 6px #003366;
      padding: 22px 12px 16px;
      margin-bottom: 20px;
      text-align: center;
      position: relative;
      overflow: hidden;
    }

    .header::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 6px;
      background: repeating-linear-gradient(90deg, var(--red) 0 18px, var(--blue) 18px 36px);
    }

    .title {
      font-size: clamp(13px, 4.5vw, 24px);
      color: var(--gold);
      text-shadow: 2px 2px 0 #000;
      animation: titleBounce 1.2s ease-in-out infinite alternate;
      line-height: 1.9;
    }

    @keyframes titleBounce {
      from {
        transform: translateY(0)
      }

      to {
        transform: translateY(-6px)
      }
    }

    .subtitle {
      font-size: clamp(7px, 2vw, 9px);
      color: #fff;
      margin-top: 8px;
      text-shadow: 1px 1px 0 #000;
      animation: rainbow 2s linear infinite;
    }

    @keyframes rainbow {
      0% {
        color: #f00
      }

      16% {
        color: #f80
      }

      33% {
        color: #ff0
      }

      50% {
        color: #0f0
      }

      66% {
        color: #08f
      }

      83% {
        color: #f0f
      }

      100% {
        color: #f00
      }
    }

    .age-badge {
      display: inline-block;
      background: var(--purple);
      color: #fff;
      font-size: clamp(8px, 2.5vw, 10px);
      padding: 6px 14px;
      border: 3px solid #000;
      box-shadow: 3px 3px 0 #000;
      margin-top: 10px;
      text-shadow: 1px 1px 0 #000;
    }

    /* DORAEMON */
    .dora-section {
      text-align: center;
      margin: 16px 0;
    }

    .dora-wrap {
      display: inline-block;
      animation: doraFloat 3s ease-in-out infinite;
    }

    @keyframes doraFloat {

      0%,
      100% {
        transform: translateY(0) rotate(-2deg)
      }

      50% {
        transform: translateY(-16px) rotate(2deg)
      }
    }

    .doraemon-svg {
      width: clamp(130px, 42vw, 175px);
      filter: drop-shadow(3px 5px 0 rgba(0, 0, 0, .35));
    }

    /* COUNTDOWN */
    .cd-section {
      background: #1a1a2e;
      border: 3px solid #000;
      box-shadow: 4px 4px 0 #000;
      padding: 16px 10px;
      margin: 16px 0;
      text-align: center;
    }

    .cd-label {
      font-size: clamp(6px, 2vw, 8px);
      color: var(--gold);
      text-shadow: 0 0 8px var(--gold);
      margin-bottom: 12px;
      display: block;
      line-height: 1.6;
    }

    .cd-grid {
      display: flex;
      justify-content: center;
      gap: 7px;
      flex-wrap: wrap;
    }

    .cd-block {
      background: var(--blue);
      border: 3px solid var(--lblue);
      box-shadow: 3px 3px 0 #000;
      padding: 10px 7px;
      min-width: 58px;
      text-align: center;
    }

    .cd-block::after {
      content: attr(data-l);
      display: block;
      font-size: 5px;
      color: #aaa;
      margin-top: 4px;
    }

    .cd-num {
      font-size: clamp(18px, 5.5vw, 26px);
      color: var(--gold);
      text-shadow: 2px 2px 0 #000;
      display: block;
      animation: numPulse 1s ease-in-out infinite;
    }

    @keyframes numPulse {

      0%,
      100% {
        transform: scale(1)
      }

      50% {
        transform: scale(1.08)
      }
    }

    .birthday-now {
      display: none;
      font-size: clamp(9px, 3vw, 13px);
      color: var(--gold);
      text-shadow: 0 0 12px gold;
      animation: rainbow 1s linear infinite;
      padding: 10px;
      line-height: 2;
    }

    /* CAKE */
    .cake-section {
      text-align: center;
      margin: 20px 0;
    }

    .cake-wrap {
      display: inline-block;
      cursor: pointer;
      -webkit-tap-highlight-color: transparent;
    }

    .cake-svg {
      width: clamp(160px, 52vw, 210px);
      filter: drop-shadow(3px 6px 0 rgba(0, 0, 0, .35));
      transition: transform .1s;
    }

    .cake-wrap:active .cake-svg {
      transform: scale(.95);
    }

    .cake-label {
      font-size: 7px;
      color: #333;
      background: var(--gold);
      border: 3px solid #000;
      padding: 5px 10px;
      margin-top: 8px;
      display: inline-block;
      box-shadow: 3px 3px 0 #000;
      animation: blink 1s step-end infinite;
    }

    @keyframes blink {

      0%,
      100% {
        opacity: 1
      }

      50% {
        opacity: .6
      }
    }

    .flame {
      animation: flameDance .35s ease-in-out infinite alternate;
      transform-origin: center bottom;
    }

    @keyframes flameDance {
      from {
        transform: scaleX(1)
      }

      to {
        transform: scaleX(1.25) scaleY(1.1) rotate(4deg)
      }
    }

    /* MESSAGE */
    .msg-section {
      background: #fff0fa;
      border: 3px solid var(--pink);
      box-shadow: 5px 5px 0 #000, 5px 5px 0 5px rgba(255, 105, 180, .25);
      padding: 18px;
      margin: 16px 0;
    }

    .msg-section::before {
      content: '‚òÖ  ‚òÖ  ‚òÖ';
      display: block;
      text-align: center;
      color: var(--pink);
      font-size: 12px;
      margin-bottom: 10px;
    }

    .msg-text {
      font-family: 'Nunito', sans-serif;
      font-size: clamp(13px, 3.8vw, 16px);
      line-height: 1.85;
      color: #333;
      font-weight: 700;
    }

    .msg-text span {
      color: var(--red);
      font-weight: 900;
    }

    /* GALLERY */
    .gallery-section {
      margin: 20px 0;
      text-align: center;
    }

    .sec-title {
      font-size: clamp(8px, 2.5vw, 11px);
      color: var(--gold);
      text-shadow: 2px 2px 0 #000;
      background: #1a1a2e;
      display: inline-block;
      padding: 7px 14px;
      border: 3px solid var(--gold);
      box-shadow: 3px 3px 0 #000;
      margin-bottom: 12px;
    }

    .gallery-hint {
      font-size: clamp(6px, 1.8vw, 7px);
      color: #333;
      margin-bottom: 10px;
    }

    .gallery-3d {
      perspective: 480px;
      height: 200px;
      position: relative;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 60px 0 4px;
    }

    .gallery-track {
      width: 100%;
      height: 190px;
      position: relative;
      transform-style: preserve-3d;
      animation: galleryRotate 14s linear infinite;
      user-select: none;
      -webkit-user-select: none;
    }

    @keyframes galleryRotate {
      from {
        transform: rotateY(0)
      }

      to {
        transform: rotateY(360deg)
      }
    }

    .gallery-track.paused {
      animation-play-state: paused;
    }

    .gallery-card {
      position: absolute;
      width: clamp(95px, 27vw, 128px);
      height: clamp(125px, 35vw, 162px);
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
      border: 3px solid #000;
      box-shadow: 3px 3px 0 #000;
      overflow: hidden;
      background: #fff;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      font-size: 7px;
      text-align: center;
      padding: 4px;
    }

    .gallery-card .gi {
      font-size: clamp(34px, 9vw, 50px);
      display: block;
      margin-bottom: 5px;
    }

    .gallery-card img {
      width: 100%;
      height: 82%;
      object-fit: cover;
      display: block;
    }

    .gallery-controls {
      display: flex;
      gap: 8px;
      justify-content: center;
      margin-top: 8px;
    }

    .gal-btn {
      background: var(--blue);
      color: #fff;
      border: 3px solid #000;
      box-shadow: 3px 3px 0 #000;
      padding: 8px 12px;
      font-family: 'Press Start 2P', monospace;
      font-size: clamp(6px, 2vw, 7px);
      cursor: pointer;
      -webkit-tap-highlight-color: transparent;
    }

    .gal-btn:active {
      transform: translate(2px, 2px);
      box-shadow: 1px 1px 0 #000;
    }

    /* PARTY BTN */
    .party-btn {
      display: block;
      margin: 14px auto;
      background: var(--red);
      color: #fff;
      border: 3px solid #000;
      box-shadow: 5px 5px 0 #000;
      padding: 13px 20px;
      font-family: 'Press Start 2P', monospace;
      font-size: clamp(8px, 2.5vw, 10px);
      cursor: pointer;
      -webkit-tap-highlight-color: transparent;
      text-align: center;
    }

    .party-btn:active {
      transform: translate(3px, 3px);
      box-shadow: 2px 2px 0 #000;
    }

    .divider {
      text-align: center;
      font-size: 9px;
      color: var(--gold);
      text-shadow: 2px 2px 0 #000;
      margin: 10px 0;
      letter-spacing: 3px;
    }

    /* GIFT */
    .gift-section {
      text-align: center;
      margin: 20px 0;
    }

    .gift-svg {
      width: clamp(115px, 38vw, 155px);
      cursor: pointer;
      filter: drop-shadow(3px 6px 0 rgba(0, 0, 0, .35));
      transition: transform .15s;
      -webkit-tap-highlight-color: transparent;
    }

    .gift-svg:active {
      transform: scale(.92) rotate(-4deg);
    }

    .gift-hint {
      font-size: clamp(6px, 2vw, 7px);
      color: var(--blue);
      margin-top: 8px;
      animation: bounce .9s ease-in-out infinite alternate;
      display: block;
    }

    @keyframes bounce {
      from {
        transform: translateY(0)
      }

      to {
        transform: translateY(-5px)
      }
    }

    /* BALLOONS */
    .balloons-layer {
      position: fixed;
      inset: 0;
      pointer-events: none;
      z-index: 10;
      overflow: hidden;
    }

    .balloon {
      position: absolute;
      bottom: -130px;
      pointer-events: none;
      animation: balloonRise linear forwards;
    }

    @keyframes balloonRise {
      0% {
        bottom: -130px;
        opacity: 1
      }

      90% {
        opacity: 1
      }

      100% {
        bottom: 110vh;
        opacity: 0
      }
    }

    /* CONFETTI */
    .confetti-piece {
      position: fixed;
      pointer-events: none;
      z-index: 9999;
      animation: confettiFall linear forwards;
    }

    @keyframes confettiFall {
      0% {
        transform: translateY(-30px) rotate(0);
        opacity: 1
      }

      100% {
        transform: translateY(100vh) rotate(720deg);
        opacity: 0
      }
    }

    .sparkle {
      position: fixed;
      pointer-events: none;
      z-index: 9998;
      animation: sparkOut .8s ease-out forwards;
    }

    @keyframes sparkOut {
      0% {
        transform: scale(0) rotate(0);
        opacity: 1
      }

      50% {
        transform: scale(1.4) rotate(180deg);
        opacity: .8
      }

      100% {
        transform: scale(0) rotate(360deg);
        opacity: 0
      }
    }

    /* MODAL */
    .modal-bg {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, .88);
      z-index: 1000;
      align-items: flex-start;
      justify-content: center;
      padding: 12px;
      overflow-y: auto;
      -webkit-overflow-scrolling: touch;
    }

    .modal-bg.open {
      display: flex;
    }

    .modal-box {
      background: #1a1a2e;
      border: 3px solid var(--gold);
      box-shadow: 6px 6px 0 #000, 0 0 30px var(--gold);
      padding: 18px 14px;
      width: 100%;
      max-width: 360px;
      text-align: center;
      position: relative;
      animation: modalPop .4s cubic-bezier(.34, 1.56, .64, 1) forwards;
      margin: auto;
      border-radius: 0;
    }

    @keyframes modalPop {
      from {
        transform: scale(0) rotate(-10deg)
      }

      to {
        transform: scale(1) rotate(0)
      }
    }

    .modal-title {
      font-size: clamp(8px, 2.5vw, 10px);
      color: var(--gold);
      margin-bottom: 12px;
      text-shadow: 0 0 8px gold;
      line-height: 1.7;
    }

    .close-modal {
      position: absolute;
      top: 6px;
      right: 6px;
      background: var(--red);
      color: #fff;
      border: 2px solid #000;
      box-shadow: 2px 2px 0 #000;
      width: 30px;
      height: 30px;
      font-size: 14px;
      cursor: pointer;
      font-weight: bold;
      display: flex;
      align-items: center;
      justify-content: center;
      -webkit-tap-highlight-color: transparent;
    }

    /* SCRATCH */
    .reveal-container {
      position: relative;
      width: 100%;
      max-width: 260px;
      height: 260px;
      margin: 0 auto 10px;
      border: 3px solid var(--gold);
    }

    .gift-art {
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      background: linear-gradient(135deg, #ff9ff3, #ffeaa7, #81ecec, #a29bfe);
      overflow: hidden;
    }

    .gift-art img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .scratch-canvas {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      cursor: crosshair;
      touch-action: none;
    }

    .prog-wrap {
      background: #333;
      border: 2px solid var(--gold);
      height: 18px;
      margin: 8px 0;
      position: relative;
      overflow: hidden;
    }

    .prog-bar {
      height: 100%;
      background: linear-gradient(90deg, var(--blue), var(--diamond));
      width: 0%;
      transition: width .2s;
      box-shadow: 0 0 8px var(--diamond);
    }

    .prog-txt {
      position: absolute;
      right: 5px;
      top: 50%;
      transform: translateY(-50%);
      font-size: 6px;
      color: #fff;
    }

    /* GUESS */
    .guess-text {
      font-size: clamp(6px, 2vw, 7px);
      color: #aaa;
      margin: 8px 0;
    }

    .guess-options {
      display: flex;
      gap: 6px;
      flex-wrap: wrap;
      justify-content: center;
      margin-bottom: 8px;
    }

    .guess-btn {
      background: var(--blue);
      color: #fff;
      border: 2px solid #000;
      box-shadow: 2px 2px 0 #000;
      padding: 8px 10px;
      font-family: 'Press Start 2P', monospace;
      font-size: clamp(6px, 2vw, 7px);
      cursor: pointer;
      -webkit-tap-highlight-color: transparent;
    }

    .guess-btn:active {
      transform: translate(2px, 2px);
      box-shadow: 0 0 0 #000;
    }

    .guess-btn.correct {
      background: var(--grass);
    }

    .guess-btn.wrong {
      background: var(--red);
    }

    .reveal-hint {
      font-size: clamp(6px, 2vw, 7px);
      color: var(--gold);
      margin: 6px 0;
      min-height: 18px;
      line-height: 1.6;
    }

    /* FOOTER */
    .footer {
      text-align: center;
      padding: 16px;
      font-size: clamp(6px, 1.8vw, 7px);
      background: var(--dirt);
      border-top: 3px solid #000;
      color: var(--gold);
      margin-top: 30px;
      line-height: 2;
    }

    .star {
      display: inline-block;
      animation: starSpin 2s linear infinite;
    }

    @keyframes starSpin {
      from {
        transform: rotate(0) scale(1)
      }

      50% {
        transform: rotate(180deg) scale(1.3)
      }

      to {
        transform: rotate(360deg) scale(1)
      }
    }

    @media(max-width:360px) {
      .cd-block {
        min-width: 50px;
        padding: 8px 5px;
      }

      .cd-num {
        font-size: 16px;
      }

      .wrap {
        padding: 8px;
      }
    }
  </style>
</head>

<body>
  <div class="sky"></div>
  <div class="ground"></div>
  <div class="balloons-layer" id="balloonsLayer"></div>
  <div id="confetti" style="position:fixed;inset:0;pointer-events:none;z-index:9999;overflow:hidden;"></div>

  <div class="wrap">

    <!-- HEADER -->
    <div class="header">
      <div class="title">üéÇ HAPPY BIRTHDAY! üéÇ<br>
        <span style="color:#fff;font-size:.65em;">‚ú® Champions of Nobita's Dream Kingdom ‚ú®</span>
      </div>
      <div class="subtitle">‚Äî Crafted with Doraemon magic</div>
      <div class="age-badge" id="ageBadge">üéâ Turning 18! üéâ</div>
    </div>

    <!-- DORAEMON -->
    <div class="dora-section">
      <div class="dora-wrap">
        <svg class="doraemon-svg" viewBox="0 0 200 225" xmlns="http://www.w3.org/2000/svg">
          <ellipse cx="100" cy="158" rx="65" ry="55" fill="#0088cc" stroke="#003366" stroke-width="3" />
          <ellipse cx="100" cy="168" rx="45" ry="38" fill="white" stroke="#eee" stroke-width="1" />
          <ellipse cx="100" cy="183" rx="30" ry="18" fill="none" stroke="#cc0000" stroke-width="3" />
          <circle cx="100" cy="82" r="62" fill="#0088cc" stroke="#003366" stroke-width="3" />
          <ellipse cx="100" cy="97" rx="48" ry="40" fill="white" stroke="#eee" stroke-width="1" />
          <circle cx="78" cy="72" r="16" fill="white" stroke="#003366" stroke-width="2" />
          <circle cx="122" cy="72" r="16" fill="white" stroke="#003366" stroke-width="2" />
          <circle cx="82" cy="74" r="8" fill="#111" />
          <circle cx="126" cy="74" r="8" fill="#111" />
          <circle cx="84" cy="71" r="3" fill="white" />
          <circle cx="128" cy="71" r="3" fill="white" />
          <circle cx="100" cy="92" r="8" fill="#cc0000" />
          <line x1="42" y1="98" x2="88" y2="102" stroke="#555" stroke-width="2" />
          <line x1="42" y1="107" x2="88" y2="106" stroke="#555" stroke-width="2" />
          <line x1="42" y1="116" x2="88" y2="110" stroke="#555" stroke-width="2" />
          <line x1="112" y1="102" x2="158" y2="98" stroke="#555" stroke-width="2" />
          <line x1="112" y1="106" x2="158" y2="107" stroke="#555" stroke-width="2" />
          <line x1="112" y1="110" x2="158" y2="116" stroke="#555" stroke-width="2" />
          <path d="M75 117 Q100 137 125 117" fill="none" stroke="#333" stroke-width="3" stroke-linecap="round" />
          <rect x="45" y="130" width="110" height="14" rx="7" fill="#cc0000" stroke="#900" stroke-width="2" />
          <circle cx="100" cy="137" r="9" fill="#FFD700" stroke="#B8860B" stroke-width="2" />
          <circle cx="100" cy="139" r="3" fill="#B8860B" />
          <ellipse cx="28" cy="162" rx="20" ry="12" fill="#0088cc" stroke="#003366" stroke-width="2"
            transform="rotate(-20 28 162)" />
          <ellipse cx="172" cy="162" rx="20" ry="12" fill="#0088cc" stroke="#003366" stroke-width="2"
            transform="rotate(20 172 162)" />
          <circle cx="16" cy="167" r="12" fill="white" stroke="#eee" stroke-width="2" />
          <circle cx="184" cy="167" r="12" fill="white" stroke="#eee" stroke-width="2" />
          <ellipse cx="78" cy="210" rx="20" ry="13" fill="#0088cc" stroke="#003366" stroke-width="2" />
          <ellipse cx="122" cy="210" rx="20" ry="13" fill="#0088cc" stroke="#003366" stroke-width="2" />
          <ellipse cx="74" cy="218" rx="24" ry="10" fill="white" stroke="#eee" stroke-width="2" />
          <ellipse cx="126" cy="218" rx="24" ry="10" fill="white" stroke="#eee" stroke-width="2" />
          <polygon points="100,8 68,52 132,52" fill="#ff69b4" stroke="#000" stroke-width="2" />
          <circle cx="100" cy="8" r="5" fill="#FFD700" />
          <rect x="66" y="50" width="68" height="6" rx="3" fill="#ff1493" />
          <text x="78" y="46" font-size="9" fill="#FFD700">‚òÖ‚òÖ‚òÖ</text>
        </svg>
      </div>
    </div>

    <div class="divider">‚óÜ ‚óÜ ‚óÜ ‚óÜ ‚óÜ</div>

    <!-- COUNTDOWN -->
    <div class="cd-section pbox">
      <span class="cd-label" id="cdLabel">‚è∞ COUNTDOWN TO BIRTHDAY ‚è∞</span>
      <div class="cd-grid" id="cdGrid">
        <div class="cd-block" data-l="DAYS"><span class="cd-num" id="days">00</span></div>
        <div class="cd-block" data-l="HOURS"><span class="cd-num" id="hours">00</span></div>
        <div class="cd-block" data-l="MINS"><span class="cd-num" id="mins">00</span></div>
        <div class="cd-block" data-l="SECS"><span class="cd-num" id="secs">00</span></div>
      </div>
      <div class="birthday-now" id="bdayNow">üéâ IT'S YOUR BIRTHDAY TODAY! üéâ</div>
    </div>

    <div class="divider">‚óÜ ‚óÜ ‚óÜ ‚óÜ ‚óÜ</div>

    <!-- CAKE -->
    <div class="cake-section">
      <div class="cake-wrap" id="cakeWrap">
        <svg class="cake-svg" viewBox="0 0 220 200" xmlns="http://www.w3.org/2000/svg">
          <ellipse cx="110" cy="188" rx="90" ry="11" fill="#ddd" stroke="#bbb" stroke-width="2" />
          <rect x="25" y="135" width="170" height="55" rx="8" fill="#ff69b4" stroke="#cc1477" stroke-width="3" />
          <line x1="60" y1="135" x2="60" y2="190" stroke="#ff1493" stroke-width="3" opacity=".4" />
          <line x1="95" y1="135" x2="95" y2="190" stroke="#ff1493" stroke-width="3" opacity=".4" />
          <line x1="130" y1="135" x2="130" y2="190" stroke="#ff1493" stroke-width="3" opacity=".4" />
          <line x1="165" y1="135" x2="165" y2="190" stroke="#ff1493" stroke-width="3" opacity=".4" />
          <path d="M25 143 Q45 130 65 143 Q85 130 105 143 Q125 130 145 143 Q165 130 185 143 L195 143 L195 135 L25 135 Z"
            fill="white" />
          <rect x="45" y="90" width="130" height="50" rx="6" fill="#87CEEB" stroke="#5599cc" stroke-width="3" />
          <rect x="50" y="95" width="18" height="18" rx="2" fill="#0088cc" opacity=".5" />
          <rect x="75" y="95" width="18" height="18" rx="2" fill="#0066aa" opacity=".5" />
          <rect x="100" y="95" width="18" height="18" rx="2" fill="#0088cc" opacity=".5" />
          <rect x="125" y="95" width="18" height="18" rx="2" fill="#0066aa" opacity=".5" />
          <rect x="150" y="95" width="18" height="18" rx="2" fill="#0088cc" opacity=".5" />
          <path d="M45 98 Q58 85 71 98 Q84 85 97 98 Q110 85 123 98 Q136 85 149 98 Q162 85 175 98 L175 90 L45 90 Z"
            fill="white" />
          <rect x="65" y="55" width="90" height="40" rx="5" fill="#FFD700" stroke="#B8860B" stroke-width="3" />
          <text x="72" y="80" font-size="16" fill="white" opacity=".8">‚ú¶ ‚ú¶ ‚ú¶</text>
          <path d="M65 62 Q77 50 89 62 Q101 50 113 62 Q125 50 137 62 Q149 50 155 62 L155 55 L65 55 Z" fill="white" />
          <rect x="83" y="28" width="10" height="30" rx="3" fill="#ff3333" />
          <rect x="105" y="22" width="10" height="36" rx="3" fill="#0088cc" />
          <rect x="127" y="28" width="10" height="30" rx="3" fill="#cc00ff" />
          <ellipse cx="88" cy="24" rx="6" ry="9" fill="#FFD700" opacity=".9" class="flame" />
          <ellipse cx="110" cy="17" rx="6" ry="9" fill="#FF8C00" opacity=".9" class="flame" />
          <ellipse cx="132" cy="24" rx="6" ry="9" fill="#FF4500" opacity=".9" class="flame" />
          <ellipse cx="88" cy="25" rx="3" ry="5" fill="white" opacity=".7" />
          <ellipse cx="110" cy="18" rx="3" ry="5" fill="white" opacity=".7" />
          <ellipse cx="132" cy="25" rx="3" ry="5" fill="white" opacity=".7" />
          <circle cx="50" cy="162" r="7" fill="#FFD700" stroke="#B8860B" stroke-width="2" />
          <circle cx="170" cy="162" r="7" fill="#FFD700" stroke="#B8860B" stroke-width="2" />
          <text x="80" y="175" font-size="14" fill="white">‚òÖ</text>
          <text x="108" y="175" font-size="14" fill="white">‚ô•</text>
          <text x="133" y="175" font-size="14" fill="white">‚òÖ</text>
        </svg>
        <div class="cake-label">üéÇ TAP ME! üéÇ</div>
      </div>
    </div>

    <!-- MESSAGE -->
    <div class="msg-section pbox">
      <p class="msg-text">
        Hey <span>Yunau</span> üíñ<br><br>
        Doraemon flew all the way from the 22nd century ‚Äî just for
        <span>YOU!</span> üåü<br><br>
        May your life be as colorful as Doraemon's gadgets and as adventurous as your inner self with infinite biomes
        to explore! May you always find rare diamonds, and always have full hearts! üíé<br><br>
        <span>Happy Birthday!</span> You deserve all the joy, magic, and cake in every dimension! üéÇ‚ú®üéâ
        I am incredibly grateful to have you as a friend. Your honest opinions, valuable life lessons, and continuous
        encouragement have consistently pushed me to become a better person.
        You have been a constant source of motivation during difficult times and have patiently listened to my stories,
        no matter how uninteresting. I consider myself truly fortunate to have a friend like you.
        <br><br>Thank you. Your support helped me move forward, and you were there to talk to me when I felt I had no
        one else.
        I sincerely apologize for consistently forgetting your birthday throughout the years. This oversight will not
        happen again. Thank you, for everything.
        <br><br>
        <span>Yours</span>
        Bitch üòâ
      </p>
    </div>

    <div class="divider">‚óÜ ‚óÜ ‚óÜ ‚óÜ ‚óÜ</div>

    <!-- 3D GALLERY -->
    <div class="gallery-section">
      <div class="sec-title">üñºÔ∏è Short Memories üñºÔ∏è</div>
      <p class="gallery-hint">Tap to pause ‚Ä¢ Swipe to spin ‚Ä¢ Use buttons to navigate</p>

      <div class="gallery-3d">
        <div class="gallery-track" id="galleryTrack"></div>
      </div>
      <div class="gallery-controls">
        <button class="gal-btn" onclick="galPrev()">‚óÄ PREV</button>
        <button class="gal-btn" id="pauseBtn" onclick="galToggle()">‚è∏ PAUSE</button>
        <button class="gal-btn" onclick="galNext()">NEXT ‚ñ∂</button>
      </div>
    </div>

    <button class="party-btn" onclick="bigParty()">üéâ LAUNCH PARTY POPPERS! üéâ</button>

    <div class="divider">‚óÜ ‚óÜ ‚óÜ ‚óÜ ‚óÜ</div>

    <!-- GIFT -->
    <div class="gift-section">
      <div class="sec-title">üéÅ YOUR SPECIAL GIFT üéÅ</div>
      <p style="font-size:clamp(6px,2vw,7px);color:#333;margin-bottom:10px;line-height:1.7;">Scratch the card to reveal
        your surprise! üéÅ</p>

      <svg class="gift-svg" viewBox="0 0 160 180" xmlns="http://www.w3.org/2000/svg" id="giftBox">
        <rect x="15" y="70" width="130" height="100" rx="4" fill="#cc44ff" stroke="#000" stroke-width="3" />
        <line x1="75" y1="70" x2="75" y2="170" stroke="#9900cc" stroke-width="3" />
        <rect x="8" y="55" width="144" height="22" rx="4" fill="#ff44aa" stroke="#000" stroke-width="3" />
        <line x1="72" y1="55" x2="72" y2="77" stroke="#cc0077" stroke-width="3" />
        <rect x="70" y="0" width="20" height="170" fill="#FFD700" opacity=".9" />
        <rect x="0" y="56" width="160" height="20" fill="#FFD700" opacity=".9" />
        <ellipse cx="55" cy="38" rx="30" ry="22" fill="#FFD700" stroke="#B8860B" stroke-width="2"
          transform="rotate(-25 55 38)" />
        <ellipse cx="105" cy="38" rx="30" ry="22" fill="#FFD700" stroke="#B8860B" stroke-width="2"
          transform="rotate(25 105 38)" />
        <circle cx="80" cy="55" r="14" fill="#FFD700" stroke="#B8860B" stroke-width="2" />
        <text x="22" y="115" font-size="20" fill="white" opacity=".7">‚òÖ</text>
        <text x="100" y="145" font-size="16" fill="white" opacity=".7">‚ú¶</text>
        <text x="108" y="100" font-size="12" fill="white" opacity=".7">‚ô¶</text>
      </svg>
      <span class="gift-hint">üëÜ TAP TO OPEN YOUR GIFT!</span>
    </div>

    <div class="footer">
      <span class="star">‚òÖ</span> Made with Doraemon magic <span class="star">‚òÖ</span><br>
      <span style="color:#ddd;font-size:5px;">DOB: Feb 22, 2007 ‚Ä¢ Wishing you an amazing birthday! üíñ</span>
    </div>

  </div><!-- /wrap -->

  <!-- GIFT MODAL -->
  <div class="modal-bg" id="giftModal">
    <div class="modal-box">
      <button class="close-modal" onclick="closeGift()">‚úï</button>
      <div class="modal-title">üéÅ WHAT'S YOUR SURPRISE? üéÅ</div>

      <div class="guess-text">Guess your gift before scratching!</div>
      <div class="guess-options">
        <button class="guess-btn" onclick="doGuess(this,false)">üíê Flowers</button>
        <button class="guess-btn" onclick="doGuess(this,false)">üíå Surprise</button>
        <button class="guess-btn" onclick="doGuess(this,true)">üçµ Crockeries</button>
        <button class="guess-btn" onclick="doGuess(this,false)">üç∞ Cake</button>
      </div>
      <div class="reveal-hint" id="revealHint">Scratch below with your finger! üëá</div>

      <div class="reveal-container">
        <div class="gift-art" id="giftArt"></div>
        <canvas class="scratch-canvas" id="scratchCanvas"></canvas>
      </div>

      <div class="prog-wrap">
        <div class="prog-bar" id="progBar"></div>
        <div class="prog-txt" id="progTxt">0%</div>
      </div>

      <button class="party-btn" style="font-size:7px;padding:10px 14px;margin:8px auto;" onclick="autoReveal()">‚ú® AUTO
        REVEAL ‚ú®</button>
    </div>
  </div>

  <script>
    // ‚îÄ‚îÄ CLOUDS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    (function () {
      for (let i = 0; i < 5; i++) {
        const c = document.createElement('div'); c.className = 'cloud';
        const s = 25 + Math.random() * 50, t = 4 + Math.random() * 28, d = 35 + Math.random() * 45;
        c.style.cssText = `width:${s * 3}px;height:${s}px;top:${t}%;box-shadow:${s}px 0 0 ${s * .5}px #fff,${s * .5}px -${s * .4}px 0 ${s * .3}px #fff,${s * 1.5}px -${s * .3}px 0 ${s * .25}px #fff;animation-duration:${d}s;animation-delay:${-Math.random() * d}s;`;
        document.querySelector('.sky').appendChild(c);
      }
    })();

    // ‚îÄ‚îÄ BALLOONS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    const bCols = ['#ff69b4', '#ff3333', '#FFD700', '#0088cc', '#cc44ff', '#00cc88', '#ff8800'];
    function mkBalloon() {
      const b = document.createElement('div'); b.className = 'balloon';
      const col = bCols[Math.floor(Math.random() * bCols.length)];
      const sz = 36 + Math.random() * 28, l = Math.random() * 95, d = 7 + Math.random() * 8;
      b.style.cssText = `left:${l}%;animation-duration:${d}s;`;
      b.innerHTML = `<svg width="${sz}" height="${sz * 1.35}" viewBox="0 0 60 82"><ellipse cx="30" cy="28" rx="26" ry="28" fill="${col}" stroke="#0003" stroke-width="1"/><ellipse cx="22" cy="18" rx="7" ry="5" fill="rgba(255,255,255,.3)"/><polygon points="30,56 25,63 35,63" fill="${col}"/><path d="M30 62 Q33 70 28 78 Q31 72 34 78" fill="none" stroke="#666" stroke-width="1.5"/></svg>`;
      document.getElementById('balloonsLayer').appendChild(b);
      setTimeout(() => b.remove(), (d + 1) * 1000);
    }
    setInterval(mkBalloon, 2200);
    for (let i = 0; i < 4; i++) setTimeout(mkBalloon, i * 600);

    // ‚îÄ‚îÄ COUNTDOWN (DOB: Feb 22, 2007) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    function getNextBirthday() {
      const now = new Date(), b = new Date(now.getFullYear(), 1, 22, 0, 0, 0, 0);
      if (now >= b) b.setFullYear(b.getFullYear() + 1);
      return b;
    }
    function calcAge(now) {
      const dob = new Date(2007, 1, 22);
      let a = now.getFullYear() - dob.getFullYear();
      if (now < new Date(now.getFullYear(), 1, 22)) a--;
      return a;
    }
    function pad(n) { return String(n).padStart(2, '0'); }

    function tick() {
      const now = new Date(), nb = getNextBirthday(), diff = nb - now;
      const currentAge = calcAge(now), nextAge = currentAge + 1;
      document.getElementById('ageBadge').textContent = `üéâ Turning ${nextAge}! üéâ`;
      document.getElementById('cdLabel').textContent = `‚è∞ COUNTDOWN TO ${nextAge}TH BIRTHDAY ‚è∞`;
      const isBday = now.getMonth() === 1 && now.getDate() === 22;
      if (isBday) {
        document.getElementById('cdGrid').style.display = 'none';
        document.getElementById('cdLabel').style.display = 'none';
        const bd = document.getElementById('bdayNow');
        bd.style.display = 'block';
        bd.innerHTML = `üéâ IT'S YOUR BIRTHDAY TODAY! üéâ<br><span style="font-size:.8em;color:#fff">Happy ${nextAge}th, gorgeous! üåü</span>`;
        return;
      }
      const dd = Math.floor(diff / 86400000), hh = Math.floor((diff % 86400000) / 3600000);
      const mm = Math.floor((diff % 3600000) / 60000), ss = Math.floor((diff % 60000) / 1000);
      document.getElementById('days').textContent = pad(dd);
      document.getElementById('hours').textContent = pad(hh);
      document.getElementById('mins').textContent = pad(mm);
      document.getElementById('secs').textContent = pad(ss);
    }
    tick(); setInterval(tick, 1000);

    // ‚îÄ‚îÄ CONFETTI ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    const confCols = ['#ff69b4', '#FFD700', '#0088cc', '#cc44ff', '#ff3333', '#00cc88', '#ff8800', '#fff'];
    const confShapes = ['‚òÖ', '‚ú¶', '‚óè', '‚ñ†', '‚ñ≤', '‚ô•', '‚óÜ'];
    function spawnConfetti(count) {
      const wrap = document.getElementById('confetti');
      for (let i = 0; i < (count || 20); i++) {
        const c = document.createElement('div'); c.className = 'confetti-piece';
        c.textContent = confShapes[Math.floor(Math.random() * confShapes.length)];
        c.style.cssText = `left:${Math.random() * 100}%;top:-20px;color:${confCols[Math.floor(Math.random() * confCols.length)]};font-size:${8 + Math.random() * 12}px;animation-duration:${2 + Math.random() * 3}s;animation-delay:${Math.random() * .5}s;transform:translateX(${(Math.random() - .5) * 200}px);`;
        wrap.appendChild(c); setTimeout(() => c.remove(), 6000);
      }
    }
    function bigParty() {
      for (let i = 0; i < 7; i++) setTimeout(() => spawnConfetti(22), i * 200);
      for (let i = 0; i < 5; i++) setTimeout(mkBalloon, i * 350);
    }

    // Cake tap
    document.getElementById('cakeWrap').addEventListener('click', cakeClick);
    document.getElementById('cakeWrap').addEventListener('touchend', cakeClick);
    function cakeClick(e) {
      e.preventDefault(); spawnConfetti(28);
      ['üéâ', '‚ú®', 'üéä', 'üí´', '‚≠ê'].forEach(s => {
        const el = document.createElement('div'); el.className = 'sparkle'; el.textContent = s;
        el.style.cssText = `left:${20 + Math.random() * 60}%;top:${10 + Math.random() * 40}%;font-size:22px;`;
        document.body.appendChild(el); setTimeout(() => el.remove(), 900);
      });
    }

    // Touch/mouse sparkles
    document.addEventListener('touchmove', e => {
      if (Math.random() > .92) {
        const t = e.touches[0];
        const s = document.createElement('div'); s.className = 'sparkle';
        s.textContent = ['‚ú®', '‚≠ê', 'üí´', '‚òÖ', '‚ô¶'][Math.floor(Math.random() * 5)];
        s.style.cssText = `left:${t.clientX}px;top:${t.clientY}px;color:${confCols[Math.floor(Math.random() * confCols.length)]};font-size:${10 + Math.random() * 8}px;`;
        document.body.appendChild(s); setTimeout(() => s.remove(), 900);
      }
    }, { passive: true });
    document.addEventListener('mousemove', e => {
      if (Math.random() > .88) {
        const s = document.createElement('div'); s.className = 'sparkle';
        s.textContent = ['‚ú®', '‚≠ê', 'üí´', '‚òÖ', '‚ô¶'][Math.floor(Math.random() * 5)];
        s.style.cssText = `left:${e.clientX}px;top:${e.clientY}px;color:${confCols[Math.floor(Math.random() * confCols.length)]};font-size:${10 + Math.random() * 8}px;`;
        document.body.appendChild(s); setTimeout(() => s.remove(), 900);
      }
    });

    // ‚îÄ‚îÄ GALLERY ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    const galleryImages = [
      { img: 'images/img1.jpg', label: 'Moment 1' },
      { img: 'images/img2.jpg', label: 'Moment 2' },
      { img: 'images/img3.jpg', label: 'Moment 3' },
      { img: 'images/img4.jpg', label: 'Moment 4' },
      { img: 'images/img5.jpg', label: 'Moment 5' },
      { img: 'images/img6.jpg', label: 'Moment 6' },
      { img: 'images/img7.jpg', label: 'Moment 7' },
      { img: 'images/img8.jpg', label: 'Moment 8' },
    ];

    let galPaused = false;
    let currentAngle = 0; // tracks the live CSS angle
    let animRunning = true;

    function buildGallery() {
      const track = document.getElementById('galleryTrack');
      track.innerHTML = '';
      const n = galleryImages.length;
      const radius = Math.min(window.innerWidth * .36, 195);
      galleryImages.forEach((it, i) => {
        const angle = (i / n) * 360;
        const card = document.createElement('div'); card.className = 'gallery-card';
        card.style.transform = `translate(-50%,-50%) rotateY(${angle}deg) translateZ(${radius}px)`;
        card.style.background = '#1a1a2e';
        card.innerHTML = `<img src="${it.img}" alt="${it.label}" onerror="this.style.display='none'"><span style="font-size:6px;color:#fff;text-shadow:1px 1px 0 #000;background:rgba(0,0,0,.55);width:100%;padding:3px;display:block;">${it.label}</span>`;
        track.appendChild(card);
      });
    }
    buildGallery();

    // Reads the current rotateY from the element's computed transform
    function getComputedAngle(el) {
      const st = window.getComputedStyle(el);
      const mx = new DOMMatrixReadOnly(st.transform);
      // For a rotateY, matrix3d gives us angle via atan2
      return Math.round(Math.atan2(mx.m13, mx.m33) * (180 / Math.PI));
    }

    function pauseGallery() {
      const track = document.getElementById('galleryTrack');
      if (!galPaused) {
        // Snapshot the current visual angle before freezing
        currentAngle = getComputedAngle(track);
        track.style.animation = 'none';
        track.style.transform = `rotateY(${currentAngle}deg)`;
        galPaused = true;
        animRunning = false;
        document.getElementById('pauseBtn').textContent = '‚ñ∂ PLAY';
      }
    }

    function galToggle() {
      const track = document.getElementById('galleryTrack');
      if (galPaused) {
        // Resume: restart animation from current angle via a dynamic keyframe
        const style = document.createElement('style');
        style.id = 'galResume';
        const existing = document.getElementById('galResume');
        if (existing) existing.remove();
        style.textContent = `@keyframes galleryResume { from{transform:rotateY(${currentAngle}deg)} to{transform:rotateY(${currentAngle + 360}deg)} }`;
        document.head.appendChild(style);
        track.style.animation = 'galleryResume 14s linear infinite';
        galPaused = false;
        animRunning = true;
        document.getElementById('pauseBtn').textContent = '‚è∏ PAUSE';
      } else {
        pauseGallery();
      }
    }

    function galPrev() {
      pauseGallery();
      currentAngle -= 45;
      document.getElementById('galleryTrack').style.transform = `rotateY(${currentAngle}deg)`;
    }

    function galNext() {
      pauseGallery();
      currentAngle += 45;
      document.getElementById('galleryTrack').style.transform = `rotateY(${currentAngle}deg)`;
    }

    // ‚îÄ‚îÄ GALLERY TOUCH/CLICK INTERACTION ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    (function () {
      const track = document.getElementById('galleryTrack');
      let touchStartX = 0;
      let resumeTimer = null;

      function scheduleResume() {
        // Auto-resume rotation 800ms after user lifts finger/mouse
        clearTimeout(resumeTimer);
        resumeTimer = setTimeout(() => {
          if (galPaused) galToggle(); // resume
        }, 800);
      }

      // Touch: pause on start, spin on move, resume on end
      track.addEventListener('touchstart', e => {
        touchStartX = e.touches[0].clientX;
        clearTimeout(resumeTimer); // cancel any pending resume
        pauseGallery();
      }, { passive: true });

      track.addEventListener('touchmove', e => {
        const dx = e.touches[0].clientX - touchStartX;
        if (Math.abs(dx) > 3) {
          currentAngle += dx * 0.4;
          track.style.transform = `rotateY(${currentAngle}deg)`;
          touchStartX = e.touches[0].clientX;
        }
      }, { passive: true });

      track.addEventListener('touchend', () => {
        scheduleResume();
      }, { passive: true });

      track.addEventListener('touchcancel', () => {
        scheduleResume();
      }, { passive: true });

      // Desktop: pause on mousedown, spin on drag, resume on mouseup
      let mouseDown = false;
      let mouseStartX = 0;
      track.addEventListener('mousedown', e => {
        mouseDown = true;
        mouseStartX = e.clientX;
        clearTimeout(resumeTimer);
        pauseGallery();
      });
      document.addEventListener('mousemove', e => {
        if (!mouseDown) return;
        const dx = e.clientX - mouseStartX;
        currentAngle += dx * 0.4;
        track.style.transform = `rotateY(${currentAngle}deg)`;
        mouseStartX = e.clientX;
      });
      document.addEventListener('mouseup', () => {
        if (!mouseDown) return;
        mouseDown = false;
        scheduleResume();
      });
    })();

    // ‚îÄ‚îÄ GIFT ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    const giftSrc = 'images/gift.jpg';

    document.getElementById('giftBox').addEventListener('click', openGift);
    document.getElementById('giftBox').addEventListener('touchend', e => { e.preventDefault(); openGift(); });

    // ‚îÄ‚îÄ SCRATCH MODAL ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    let sCtx, sCanvas, totalPx, revealed = false, sDrawing = false, lastCheck = 0;

    function openGift() {
      document.getElementById('giftModal').classList.add('open');
      document.body.style.overflow = 'hidden';
      setTimeout(initScratch, 80); bigParty();
    }
    function closeGift() {
      document.getElementById('giftModal').classList.remove('open');
      document.body.style.overflow = '';
    }

    function initScratch() {
      const old = document.getElementById('scratchCanvas');
      const fresh = old.cloneNode(false);
      old.parentNode.replaceChild(fresh, old);
      sCanvas = fresh;

      const wrap = sCanvas.parentElement;
      const w = wrap.offsetWidth, h = wrap.offsetHeight;
      sCanvas.width = w; sCanvas.height = h;
      sCtx = sCanvas.getContext('2d');

      const art = document.getElementById('giftArt');
      if (giftSrc) {
        art.innerHTML = `<img src="${giftSrc}" alt="Gift surprise">`;
      } else {
        art.innerHTML = `<div style="width:100%;height:100%;background:linear-gradient(135deg,#ff9ff3,#ffeaa7,#81ecec,#a29bfe);display:flex;flex-direction:column;align-items:center;justify-content:center;gap:8px;"><div style="font-size:56px;">üíù</div><div style="font-family:'Press Start 2P',monospace;font-size:8px;color:#fff;text-shadow:2px 2px 0 #000;text-align:center;line-height:2;">LOVE &amp;<br><span style="color:#FFD700;">BIRTHDAY</span><br>WISHES!</div><div style="font-size:22px;">‚ú®üéâ‚ú®</div></div>`;
      }

      // Minecraft-textured scratch overlay
      const grd = sCtx.createLinearGradient(0, 0, w, h);
      grd.addColorStop(0, '#5a8a3c'); grd.addColorStop(.5, '#4a7a2c'); grd.addColorStop(1, '#8B6914');
      sCtx.fillStyle = grd; sCtx.fillRect(0, 0, w, h);
      sCtx.strokeStyle = 'rgba(0,0,0,.15)';
      for (let x = 0; x < w; x += 18) { sCtx.beginPath(); sCtx.moveTo(x, 0); sCtx.lineTo(x, h); sCtx.stroke(); }
      for (let y = 0; y < h; y += 18) { sCtx.beginPath(); sCtx.moveTo(0, y); sCtx.lineTo(w, y); sCtx.stroke(); }
      sCtx.fillStyle = 'rgba(255,215,0,.85)';
      const fs = Math.max(10, Math.floor(w / 17));
      sCtx.font = `bold ${fs}px monospace`; sCtx.textAlign = 'center';
      sCtx.fillText('‚ú¶ SCRATCH HERE ‚ú¶', w / 2, h * .42);
      sCtx.font = `bold ${Math.floor(fs * .85)}px monospace`;
      sCtx.fillText('üéÅ Gift Awaits!', w / 2, h * .58);

      totalPx = w * h; revealed = false; lastCheck = 0;
      document.getElementById('progBar').style.width = '0%';
      document.getElementById('progTxt').textContent = '0%';
      document.getElementById('revealHint').textContent = 'Scratch the card to reveal! üëá';
      document.getElementById('revealHint').style.color = 'var(--gold)';
      document.getElementById('revealHint').style.animation = 'none';
      document.querySelectorAll('.guess-btn').forEach(b => b.classList.remove('correct', 'wrong'));

      sCanvas.addEventListener('mousedown', () => sDrawing = true);
      sCanvas.addEventListener('mouseup', () => sDrawing = false);
      sCanvas.addEventListener('mouseleave', () => sDrawing = false);
      sCanvas.addEventListener('mousemove', e => { if (sDrawing) scratch(e.offsetX, e.offsetY); });
      sCanvas.addEventListener('touchstart', e => { sDrawing = true; e.preventDefault(); }, { passive: false });
      sCanvas.addEventListener('touchend', () => sDrawing = false);
      sCanvas.addEventListener('touchcancel', () => sDrawing = false);
      sCanvas.addEventListener('touchmove', e => {
        e.preventDefault();
        const r = sCanvas.getBoundingClientRect();
        scratch(e.touches[0].clientX - r.left, e.touches[0].clientY - r.top);
      }, { passive: false });
    }

    function scratch(x, y) {
      sCtx.globalCompositeOperation = 'destination-out';
      sCtx.beginPath(); sCtx.arc(x, y, 30, 0, Math.PI * 2); sCtx.fill();
      const now = Date.now(); if (now - lastCheck < 180) return; lastCheck = now;
      const data = sCtx.getImageData(0, 0, sCanvas.width, sCanvas.height).data;
      let trans = 0; for (let i = 3; i < data.length; i += 4) if (data[i] < 128) trans++;
      const pct = Math.min(100, Math.round((trans / totalPx) * 100));
      document.getElementById('progBar').style.width = pct + '%';
      document.getElementById('progTxt').textContent = pct + '%';
      if (pct > 65 && !revealed) { revealed = true; onReveal(); }
    }

    function onReveal() {
      bigParty(); spawnConfetti(40);
      const h = document.getElementById('revealHint');
      h.textContent = 'üéâ HAPPY BIRTHDAY! Surprise revealed! üéâ';
      h.style.color = '#ff69b4'; h.style.animation = 'rainbow 1s linear infinite';
    }

    function autoReveal() {
      if (!sCtx) return; let step = 0;
      const iv = setInterval(() => {
        const cols = Math.ceil(sCanvas.width / 28), rows = Math.ceil(sCanvas.height / 28);
        for (let r = 0; r < rows; r++) for (let c = 0; c < cols; c++) if (Math.random() < .2) scratch(c * 28 + 14, r * 28 + 14);
        if (++step > 22) clearInterval(iv);
      }, 55);
    }

    function doGuess(btn, correct) {
      document.querySelectorAll('.guess-btn').forEach(b => b.classList.remove('correct', 'wrong'));
      btn.classList.add(correct ? 'correct' : 'wrong');
      const h = document.getElementById('revealHint');
      if (correct) { h.textContent = '‚úÖ You guessed right! Now scratch to see!'; h.style.color = '#00cc44'; bigParty(); }
      else { h.textContent = '‚ùå Nope! Keep guessing or just scratch!'; h.style.color = '#ff3333'; }
    }

    // ‚îÄ‚îÄ INIT ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    setTimeout(bigParty, 800);
    setTimeout(bigParty, 2600);
  </script>
</body>

</html>
